# MyAI Chat History (Ver1.23)

## 概要

「MyAI Chat History」は、Google Gemini API を利用して AI との会話を記録し、管理するためのオフライン対応チャットアプリケーションです。全てのデータはブラウザのローカルストレージに保存されるため、プライバシーを気にせず安心してご利用いただけます。チャットの要約生成、履歴の保存と読み込み、PDFエクスポート、音声入力・読み上げなど、多様な機能を備えています。

## 機能

*   **AIチャット:**
    *   Google Gemini API を介した AI との対話。
    *   テキスト入力、画像添付（ペーストまたはファイル選択）、音声入力（Web Speech API）。
    *   メッセージの選択、削除、編集、音声再生。
    *   AIからの応答時にサウンド通知と音声読み上げ（Text-to-Speech）機能。
*   **チャット履歴管理:**
    *   現在のチャット内容を AI が自動でタイトルと要約を生成し、履歴として保存。
    *   保存された履歴の一覧表示、検索、ソート（日付、タイトル）。
    *   選択した履歴の読み込み、複数選択による一括削除。
    *   全チャット履歴のJSON形式でのエクスポート/インポート機能。
*   **設定:**
    *   **API設定:** Gemini API キーの入力、保存、テスト、削除。
    *   **各種設定:**
        *   AIの性格（システムプロンプト）のカスタマイズとプリセット例。
        *   チャット概要生成プロンプトのカスタマイズ。
        *   ユーザー名とAI名の設定。
        *   AI応答時のサウンド（オン/オフ、種類）設定。
        *   AI応答の音声読み上げ（オン/オフ、音声の種類、速度、ピッチ、音量）設定。
        *   設定内容のCSV形式でのエクスポート/インポート機能。
*   **PDF出力:**
    *   現在表示中のチャット履歴をPDF形式でプレビューし、ダウンロード。
*   **ローカルストレージ情報:**
    *   サイドパネルにローカルストレージの使用量をリアルタイムで表示（MBとパーセンテージ）。
    *   ストレージ使用量が閾値を超えた場合に警告表示。

## はじめに

### 前提条件

*   モダンなWebブラウザ (Google Chrome, Mozilla Firefox, Microsoft Edge など)。
*   Google Gemini API キー。まだお持ちでない場合は、[Google AI Studio](https://aistudio.google.com/app/apikey) で取得してください。

### セットアップ

1.  この `index.html` ファイルを任意の場所に保存します。
2.  保存した `index.html` ファイルをWebブラウザで開きます。

### APIキーの設定

1.  アプリケーションのヘッダーにある「**API設定**」ボタンをクリックします。
2.  「Gemini APIキー設定」モーダルで、取得した Gemini API キーを入力します。
3.  「**APIキーをテスト**」ボタンをクリックして、APIキーが有効であることを確認します。
4.  「**保存**」ボタンをクリックして、APIキーをブラウザのローカルストレージに保存します。

これで、AIとのチャットを開始する準備が整いました。

## 使い方

### チャットの開始

*   ページを開くと自動的に新しいチャットが開始されます。
*   途中で新しいチャットを開始したい場合は、ヘッダーの「**新しいチャット**」ボタンをクリックします。

### メッセージの送信

1.  下部のテキスト入力欄にメッセージを入力します。
2.  `Enter` キーを押すとメッセージが送信されます (`Shift + Enter` で改行)。
3.  「**画像を選択**」ボタン (`📎`) をクリックするか、画像をテキスト入力欄に直接ペーストして画像を添付できます。
4.  「**音声入力**」ボタン (`🎤`) をクリックすると、マイクからの音声でメッセージを入力できます。

### チャットの保存と履歴の管理

1.  現在のチャットを保存するには、ヘッダーの「**チャット保存**」ボタンをクリックします。AIがタイトルと要約を生成し、保存します。
2.  保存されたチャット履歴を一覧表示するには、ヘッダーの「**履歴一覧**」ボタンをクリックします。
3.  履歴一覧からチェックボックスで項目を選択し、「**選択を読込**」でチャットを復元したり、「**選択を削除**」で不要な履歴を削除したりできます。
4.  履歴はタイトルや日付で検索したり、ソート順を変更したりできます。
5.  「各種設定」モーダル内で、すべてのチャット履歴をJSONファイルとしてエクスポート/インポートできます。

### 各種設定

1.  ヘッダーの「**各種設定**」ボタンをクリックして、AIの性格、名前、サウンド、音声読み上げなどの詳細設定を行います。
2.  設定変更後は必ず「**保存**」ボタンをクリックしてください。
3.  設定はCSVファイルとしてエクスポート/インポートすることも可能です。

### PDFプレビュー

1.  保存済み、または現在アクティブなチャット履歴がある場合、ヘッダーの「**PDFプレビュー**」ボタンでPDFでの表示を確認できます。
2.  PDFビューア内の「**PDFをダウンロード**」ボタンで、適切なファイル名でPDFを保存できます。

### ローカルストレージ情報

*   サイドパネルの下部には、ブラウザのローカルストレージの使用状況がリアルタイムで表示されます。
*   画像を含むチャット履歴は多くのストレージを消費する可能性があります。使用量が上限に近づいた場合は、古い履歴を削除することを検討してください。

## 注意事項

*   **データストレージ:** APIキー、会話履歴、チャット履歴、各種設定はすべてお使いのブラウザのローカルストレージに保存されます。**これらのデータが外部サーバーに送信されたり保存されたりすることはありません。**
*   **データ損失の可能性:** ブラウザのキャッシュや履歴を消去すると、ローカルストレージに保存されたデータがすべて失われる可能性があります。重要なデータは、JSONエクスポート機能を利用して定期的にバックアップしてください。
*   **Gemini API 利用料金:** Gemini API の利用には、APIキーを発行したご自身のGoogleアカウントに利用料金が発生する場合があります。利用量にご注意ください。

## 技術スタック

*   **HTML:** アプリケーションの構造
*   **CSS:** スタイリング
*   **JavaScript:** アプリケーションのロジック、Gemini API との連携、Web Speech API、Web SpeechSynthesis API、DOM操作
*   **html2pdf.js:** PDF生成ライブラリ

## ライセンス

このコードは個人利用を想定して提供されており、明示的なライセンスは付与されていません。
ご自身の責任においてご利用ください。